--------------------------------LIBRARY SYSTEM-------------------------
-----create member Table

create table Member(
    -> member_id int unique,
    -> member_name varchar(30) not null,
    -> member_address varchar(50),
    -> Acc_open_Date  date,
    -> Membership_type varchar(20),
    -> Fees_paid int ,
    -> Max_Books_Allowed int,
    -> Penalty_Amount decimal(7,2)
    -> );

------create table Books

 create table Books(
    -> Book_no int,
    -> Book_Name varchar(30),
    -> Author_name varchar(30),
    -> Cost decimal(7,2),
    -> Category char(10)
    -> );

-----create table Issue

 create table Issue(
    -> Lib_Issue_id int,
    -> Book_No int,
    -> Member_id int,
    -> Issue_date date,
    -> Return_date date
    -> );
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

2) View the structure of the tables.........

    Desc Member;
    Desc Books;
    Desc Issue;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

3) Drop the Member table..........

    DROP table member;
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

4) Create the table Member again as per the schema description with the
   following constraints.
    a. Member_Id – Primary Key 
    b. Membership_type - ‘Lifetime’,’ Annual’, ‘Half Yearly’,’ Quarterly’


  create table Member(
    -> member_id int primary key,
    -> Member_name varchar(30),
    -> Member_Address varchar(50),
    -> Acc_Open_Date date,
    -> Membership_type varchar(20) check (Membership_type in ('Lifetime','Annual','Half Yearly','Quarterly')),
    -> Fees_paid int ,
    -> Max_Books_Allowed  int,
    -> Penalty_Amount decimal(7,2)
    -> );




----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5) Modify the table Member increase the width of the member name to 30    characters.
 
   alter table member
    -> modify column member_name varchar(30);


----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6) Add a column named as Reference of Char(30) to Issue table.
      
      --- Add column reference
     ->  alter table issue
    -> add column reference char(30);

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

7) Delete/Drop the column Reference from Issue.
     --delete reference table 

     -> alter table issue
    -> drop column reference;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

8) Rename the table Issue to Lib_Issue.......
     
       rename table issue to Lib_issue;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

9) Insert following data in table Member....
 
    insert into member(member_id,member_name,member_address,Acc_Open_date,membership_type,Fees_paid,max_books_Allowed,penalty_amount) values
    -> (1,"Richa Sharma","pune","10-12-05","Lifetime",25000,5,50);
  
    insert into member(member_id,member_name,member_address,Acc_Open_date,membership_type,Fees_paid,max_books_Allowed) values
    -> (2,'Garima Sen','Pune','2025-09-23','Annual',1000,3);

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

10) Insert at least 5 records with suitable data.
  

-----insert into member at least 5 records
    
       -> insert into member values(5,'Shankar Ingle ','Mukhed','2025-06-15','Half yearly',2545,04,60),
    -> (6,'Tejas Kadam',"Pune",'2024-4-12','Annual',1254,6,45),
    -> (7,'Shree wankhede','Pune','2025-06-25','half yearly',9650,05,70),
    -> (8,'shubham patil','degloor','2023-04-05','Quarterly',1050,5,40),
    -> (9,'omkar kadam','Nanded','2024-05-4','Lifetime',2025,6,90);
     
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 11) Modify the column Member_name. Decrease the width of the member
    name to 20 characters. (If it does not allow state the reason for that)
     
     

      ->alter table member
    -> modify column member_name char(20);


  ------ if does not allow state gives error

     -> alter table member
    -> modify column member_name char(10);
      ERROR 1265 (01000): Data truncated for column 'member_name' at row 1
 
     reason..

    You changed member_name to CHAR(10) → which means the column can now store only 10 characters maximum.
    But in row 1, the value of member_name is longer than 10 characters.
    Example: "Shankar Ingle" has 13 characters, which is greater than 10.

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    12) Try to insert a record with Max_Books_Allowed = 110, Observe the
         error that comes.

      ---->insert Max_books 110

        -->  insert into member values(10,'Sakshi Sinha','Pune','2023-05-15','annual',45000,110,500);
             Query OK, 1 row affected (0.06 sec)





----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   13) Generate another table named Member101 using a Create command
       along with a simple SQL query on member table.

      -------generate another table
        -> create table member101 as (select *from member);
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    14) Add the constraints on columns max_books_allowed and penalty_amt
       as follows
      a. max_books_allowed < 100
      b. penalty_amt maximum 1000
         Also give names to the constraints.

       alter table member
    -> add constraint Book_penalty_check 
    ->  check (max_books_allowed < 100 AND penalty_amount < 1000);

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    15) Drop the table books.
       
        -> drop table books;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    16) Create table Books again as per the schema description with the
        following constraints.
        a. Book_No – Primary Key
        b. Book_Name – Not Null
        c. Category – System, Fiction, Database, RDBMS, Others.
    
    -----create table books 

      create table books(
    -> book_no int primary key,
    -> book_name varchar(30) not null,
    -> category enum('system','fiction','database','RDBMS','Others'));

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      17) Insert data in Book table as follows:


    -> insert into books values(101,'Let us C','Denis Ritchie',450,'System'),
    -> (102,'Oracle_Complete Ref','Loni',550,'Database'),
    -> (103,'Mastering SQl','Loni',250,'Database'),
    -> (104,'PL SQL_Ref','Scott Urman',750,'database');

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    18) Insert more records in Book table.
          
        insert into books values
    -> (105, 'Java Complete Reference', 'Herbert Schildt', 650.00, 'system'),
    -> (106, 'Operating System Concepts', 'Silberschatz', 720.00, 'system'),
    -> (107, 'Database System Concepts', 'Korth', 800.00, 'database'),
    -> (108, 'Data Structures Using C', 'Yashwant Kanetkar', 500.00, 'system'),
    -> (109, 'Harry Potter', 'J.K. Rowling', 450.00, 'fiction'),
    -> (110, 'Modern RDBMS Concepts', 'C.J. Date', 900.00, 'RDBMS');

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     19) View the data in the tables using simple SQL query.
         
        -> select * from table books;
        -> select * from table member;
        -> select * from table lib_issue;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      20) Insert into Book following data.
         105, National Geographic, Adis Scott, 1000, Science
         
        -> insert into books values(111,'national geographic','Adis Scott',1000,'Science');

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      21) Rename the table Lib_Issue to Issue.
           
           -> rename table lib_issue to Isuue;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
       22) Drop table Issue.
           
          ->drop table issue;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
       23) As per the given structure Create table Issue again with following
           constraints.
            Lib_Issue_Id-Primary key
            Book_No- foreign key
            Member_id - foreign key
            Issue_date
            Return_date
          
    -> create table Issue(
    -> Lib_issue_id int primary key,
    -> book_no int,
    -> member_id int,
    -> issue_date date,
    -> Return_date date,
    ->  constraint fK_key foreign key(book_no)
    -> references books(book_no),
    ->  constraint fk_key_1 foreign key(member_id)
    -> references member(member_id));

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      24) Insert following data into Issue table.
    Lib_Issue_Id    Book No Member ID Issue Date
    7001          101    1        10-Dec-06
    7002          102    2        25-Dec-06
    7003          104    1        15-Jan-06
    7004          101    1        04-Jul-06
    7005          104    2        15-Nov-06
    7006          101    3        18-Feb-06



      -> insert into issue(lib_issue_id,book_no,member_id,issue_date)values
    -> (7001,101,1,'2006-12-10'),
    -> (7002,102,2,'2006-12-25'),
    -> (7003,104,1,'2006-06-15'),
    -> (7004,101,1,'2006-07-04'),
    -> (7005,104,2,'2006-11-15'),
    -> (7006,101,3,'2006-02-18');





----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      25) Remove the constraints on Issue table
        
          ->alter table issue
    -> drop foreign key fk_key,
    -> drop foreign key fk_key_1,
    -> drop primary key;

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      26) Insert a record in Issue table. The member_id should not exist in
           member table.

        insert into issue(lib_issue_id,book_no,member_id,issue_date)values
    -> (7007,105,11,'2006-04-27');

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      
      27) Now enable the constraints of Issue table. Observe the error
        

        alter table issue
    -> add constraint foreign key(book_no)
    ->
    -> references books(book_no),
    -> add constraint foreign key(member_id)
    -> references member(member_id),
    -> add primary key(lib_issue_id);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`library_system`.`#sql-142c_43`, CONSTRAINT `issue_ibfk_2` FOREIGN KEY (`member_id`) REFERENCES `member` (`member_id`))

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      28) Delete the record inserted at Q-27) and enable the constraints.
         
      ----Delete entry of Q.26

    -> delete from issue
    -> where member_id=11;
     
     enable constraints
     
    -> alter table issue
    -> add constraint foreign key(book_no)
    -> references books(book_no),
    -> add constraint foreign key(member_id)
    -> references member(member_id),
    -> add primary key(lib_issue_id);

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     29) Try to delete the record of member id 1 from member table and
         observe the error .
       
      -> delete feom member
    -> where member_id=1;
    ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'member
    where member_id=1' at line 1
         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      30) View the data and structure of all the three tables Member,
          Issue, Book. 
         
    ---------view data of all table
         
         ->select * from member;
         -> Select * from books;
         -> Select * from issue;

------structure of table

         -> Show create table member;
         -> show create table books;
         -> Show create table issue;
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      31) Modify the Return_Date of 7004,7005 to 15 days after the
           Issue_date.
         
     ----add return date 
            
       ->update issue
       -> set return_date=date_add(issue_date,interval 15 day)
       -> where lib_issue_id in(7004,7005);
       
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
     32) Remove all the records from Issue table where member_ID is 1
         and Issue date in before 10-Dec-06.


       -> delete from issue
      -> where member_id=1 and issue_date < "2006-12-10";     
               
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
       33) Remove all the records from Book table with category other
           than RDBMS and Database.       
          
       ->delete from books
       ->where category not in("rdbms","database");
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

      34) Remove the table Member.
     
           -> drop table member;



---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      35) Remove the table Book.

          ->drop table books;

