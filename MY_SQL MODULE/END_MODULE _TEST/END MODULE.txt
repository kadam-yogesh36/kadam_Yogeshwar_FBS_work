Name: Kadam Yogeshwar 
Batch: 11th July java 
SET: B
FRN-NO:FRN-13J0725/022
-------------------------------------------------------------------------------------------------------------------------------------

1. Retrieve the names of all customers from the `Customers` table, sorted in alphabetical order. 

->select name from customers 
->order by name;

------------------------------------------------------------------------------------------------------------------------------------
2. Fetch the top 10 most expensive products from the `Products` table. 

-> select * from products 
->order by price desc limit 10;

--------------------------------------------------------------------------------------------
3. Write a query to get the second-highest salary from the `Employees` table. 

-> SELECT * FROM EMPLOYEES 
->ORDER BY SALARY DESC LIMIT 2,1;

--------------------------------------------------------------------------------------------
4. Get the total count of customers from each city in the `Customers` table.

-> SELECT CITY, COUNT(*) AS "TOTAL_CUSTOMERS" FROM CUSTOMERS
-> GROUP BY CITY;

-------------------------------------------------------------------------------------------- 
5. Retrieve department-wise total salary from the `Employees` table but only include 
departments where the total salary is greater than 2,00,000. 

->SELECT DEPT_NAME,SUM(SALARY)AS "TOTAL_SALARY" FROM EMPLOYEES
 ->GROUP BY DEPT_NAME 
 ->HAVING SUM(SALARY) > 200000;

--------------------------------------------------------------------------------------------
6. Extract only the last four characters of the `phone_number` column and first three characters 
from `customerName` columns from the `Customers` table. 

->select right(phone_number,4),left(customername,3) from customers;
--------------------------------------------------------------------------------------------
7. Write a query to retrieve products where the `product_name` contains "Pro".

->SELECT PRODUCT_NAME FROM PRODUCTS
 -> WHERE PRODUCT_NAME LIKE '%PR0%';
 
--------------------------------------------------------------------------------------------
8. Fetch the total number of students per course from the `Students` table, only for courses that 
have at least 30 students enrolled.

->SELECT COURSE,COUNT(*) FROM STUDENTS 
->GROUP BY COURSE
->HAVING COUNT(*)>=30;
 
--------------------------------------------------------------------------------------------
9. Write an SQL query to find the number of orders placed in each month of the year.
 
->SELECT MONTH(ORDER_DATE) AS "MONTH",COUNT(*)AS "NO OF ORDERS" FROM ORDERS
->GROUP BY MONTH(ORDER_DATE);

-------------------------------------------------------------------------------------------- 
10. Get the highest and lowest salary per department from the `Employees` table.
 
->SELECT DEPT_NAME,MAX(SALRY)AS "HIGHEST SALARY",MIN(SALARY)AS "LOWEST SALARY" FROM EMPLOYEES
->GROUP BY DEPT_NAME;

--------------------------------------------------------------------------------------------
11. What does the following query return? 
SELECT SUBSTRING('Database', 1, 4); 
a) Data 
b) tabase 
c) DataB 
d) Error 

ANS-> A)DATA
--------------------------------------------------------------------------------------------
12. Which clause is used to sort the results in descending order? 
a) ORDER BY DESC 
b) ORDER BY ASC 
c) SORT BY DESC 
d) GROUP BY DESC
ANS->  A) ORDER BY DESC
--------------------------------------------------------------------------------------------

13. What is the default sorting order of `ORDER BY` if no direction (ASC/DESC) is specified? 
a) ASC 
b) DESC 
c) No specific order 
d) Error 
ANS->  A) ASC

--------------------------------------------------------------------------------------------
14. What will be the output of the following query? 
SELECT ROUND(15.678, 2); 
a) 15.67 
b) 15.68 
c) 15.7 
d) 16 
ANS->  b)16.68

--------------------------------------------------------------------------------------------
15. Which SQL function is used to count the number of rows in a table? 
a) TOTAL() 
b) COUNT() 
c) SUM() 
d) NUMBER() 

ANS->  B) COUNT()

--------------------------------------------------------------------------------------------
16. Question: 
You have two tables: 
• Orders with columns: order_id, customer_id, order_date, total_amount. 
• Customers with columns: customer_id, customer_name. 
• O/P- customer_id, customer_name, avg_order_value 

->SELECT C.CUSTOMER_ID,CUSTOMER_NAME,AVG(TOTAL_AMOUNT) FROM ORDERS O
->INNER  JOIN  CUSTOMERS C
->ON C.CUSTOMER_ID=O.CUSTOMERS_ID
-> GROUP BY CUSTOMER_NAME;
--------------------------------------------------------------------------------------------
17. Write an SQL query to find the average order value (total_amount) for each customer. Only 
include customers who have made more than 2 orders.

->SELECT C.CUSTOMER_ID,CUSTOMER_NAME,COUNT(*)AS "NO OF ORDERS",AVG(TOTAL_AMOUNT) FROM ORDERS O
->INNER  JOIN  CUSTOMERS C
->ON C.CUSTOMER_ID=O.CUSTOMERS_ID
-> GROUP BY CUSTOMER_NAME
->HAVING COUNT(*) > 2;

--------------------------------------------------------------------------------------------
